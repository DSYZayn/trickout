import{e as g,a as v}from"./cast-4d1aa82d.js";import{n as x}from"./Evented-d69b5d66.js";import{p as b}from"./string-bf9c68ed.js";import"./Error-9392329b.js";import"./ensureType-8c80e8c7.js";const w=new x.EventEmitter,m="esri.layers.mixins.EditBusLayer",F=Symbol(m);function T(d){return d!=null&&typeof d=="object"&&F in d}const U=d=>{var r;let l=class extends d{constructor(...y){super(...y),this[r]=!0,this.when().then(()=>{this.own([w.on("edits",t=>{var n,u,h;const p="layer"in t?t.layer:null,f="layer"in t?(n=t.layer)==null?void 0:n.url:t.serviceUrl,a="layer"in t?(u=t.layer)==null?void 0:u.layerId:t.layerId,s=t.event;if(p===this||f!==this.url)return;if(a!=null&&this.layerId!=null&&a===this.layerId)return void this.emit("edits",b(s));const o=(h=s.editedFeatures)==null?void 0:h.find(({layerId:i})=>i===this.layerId);if(o){const{adds:i,updates:c,deletes:I}=o.editedFeatures,j={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:i?i.map(({attributes:e})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]})):[],deletedFeatures:I?I.map(({attributes:e})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]})):[],updatedFeatures:c?c.map(({current:{attributes:e}})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]})):[],editedFeatures:b(s.editedFeatures),exceededTransferLimit:!1};this.emit("edits",j)}})])},()=>{})}};return r=F,l=g([v(m)],l),l};export{U as a,w as d,T as o};

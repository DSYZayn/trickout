import{e as s,y,a as T,H as G,I as A}from"./cast-4d1aa82d.js";import{a as g}from"./Error-9392329b.js";import{Z as h}from"./request-429c0e66.js";import"./ensureType-8c80e8c7.js";import{r as m}from"./typedArrayUtil-c81d173a.js";import{a as v,f as O,r as d}from"./Extent-52b65909.js";import{T as L,n as u}from"./TimeExtent-0fb637c6.js";import{f as M}from"./persistableUrlUtils-ef87bc82.js";import"./string-bf9c68ed.js";import{x as j}from"./ElevationInfo-280697dd.js";import{r as I}from"./opacityUtils-a1e441cd.js";function $(a){if(!a)return a;const{start:e,end:t}=a;return new L({start:m(e)?u(e,-e.getTimezoneOffset(),"minutes"):e,end:m(t)?u(t,-t.getTimezoneOffset(),"minutes"):t})}function D(a){if(!a)return a;const{start:e,end:t}=a;return new L({start:m(e)?u(e,e.getTimezoneOffset(),"minutes"):e,end:m(t)?u(t,t.getTimezoneOffset(),"minutes"):t})}const H={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:!0}},K={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(a,e)=>!e.disablePopup},write:{enabled:!0,writer(a,e,t){e[t]=!a}}}},U={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:!0}},k={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:M}}},Z={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:!0}},_={value:null,type:j,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:!0}};function Q(a){return{type:a,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const b={write:!0,read:!0},w={type:Number,json:{origins:{"web-document":b,"portal-item":{write:!0}}}},X={...w,json:{...w.json,origins:{"web-document":{...b,write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(a,e,t)=>t&&t.origin!=="service"||!e.drawingInfo||e.drawingInfo.transparency===void 0?e.layerDefinition&&e.layerDefinition.drawingInfo&&e.layerDefinition.drawingInfo.transparency!==void 0?I(e.layerDefinition.drawingInfo.transparency):void 0:I(e.drawingInfo.transparency)}}},Y={type:L,readOnly:!0,get(){var p,c;if(!((p=this.layer)!=null&&p.timeInfo))return null;const{datesInUnknownTimezone:a,timeOffset:e,useViewTime:t}=this.layer,n=(c=this.view)==null?void 0:c.timeExtent;let r=this.layer.timeExtent;a&&(r=D(r));let i=t?n&&r?n.intersection(r):n||r:r;if(!i||i.isEmpty||i.isAllTime)return i;e&&(i=i.offset(-e.value,e.unit)),a&&(i=$(i));const o=this._get("timeExtent");return i.equals(o)?o:i}},ee={type:v,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(a,e)=>{const t=v.fromJSON(a);return e.spatialReference!=null&&typeof e.spatialReference=="object"&&(t.spatialReference=O.fromJSON(e.spatialReference)),t}}}},read:!1}},re={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},ie={type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"}}},ae={type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"}}},N={json:{write:{ignoreOrigin:!0},origins:{"web-map":{read:!1,write:!1}}}},B={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,OGCFeatureLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,GeoJSON:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,KML:!0,RasterDataLayer:!0,Voxel:!0,LineOfSightLayer:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-map/operational-layers":{ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CSV:!0,GeoRSS:!0,GeoJSON:!0,GroupLayer:!0,KML:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-map/basemap":{ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},"web-map/tables":{ArcGISFeatureLayer:!0},"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISSceneServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0,OrientedImageryLayer:!0}},te=a=>{let e=class extends a{constructor(){super(...arguments),this.title=null}writeListMode(n,r,i,o){(o&&o.layerContainerType==="ground"||n&&G(this,i,{},o))&&(r[i]=n)}writeOperationalLayerType(n,r,i,o){!n||o&&o.layerContainerType==="tables"||(r.layerType=n)}writeTitle(n,r){r.title=n??"Layer"}read(n,r){r&&(r.layer=this),A(this,n,i=>super.read(n,i),r)}write(n,r){var p,c;if(r!=null&&r.origin){const l=`${r.origin}/${r.layerContainerType||"operational-layers"}`,f=B[l];let S=f&&f[this.operationalLayerType];if(this.operationalLayerType==="ArcGISTiledElevationServiceLayer"&&l==="web-scene/operational-layers"&&(S=!1),this.operationalLayerType==="ArcGISDimensionLayer"&&l==="web-map/operational-layers"&&(S=!1),!S)return(p=r.messages)==null||p.push(new g("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${l}'`,{layer:this})),null}const i=super.write(n,{...r,layer:this}),o=!!r&&!!r.messages&&!!r.messages.filter(l=>l instanceof g&&l.name==="web-document-write:property-required").length;return h(i==null?void 0:i.url)?((c=r==null?void 0:r.messages)==null||c.push(new g("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&o?null:i}beforeSave(){}};return s([y({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],e.prototype,"id",void 0),s([y(N)],e.prototype,"listMode",void 0),s([d("listMode")],e.prototype,"writeListMode",null),s([y({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1}}}})],e.prototype,"operationalLayerType",void 0),s([d("operationalLayerType")],e.prototype,"writeOperationalLayerType",null),s([y(w)],e.prototype,"opacity",void 0),s([y({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],e.prototype,"title",void 0),s([d("title"),d(["web-scene"],"title")],e.prototype,"writeTitle",null),s([y({type:Boolean,json:{name:"visibility"}})],e.prototype,"visible",void 0),e=s([T("esri.layers.mixins.OperationalLayer")],e),e};export{ae as D,ie as I,N as S,Z as a,Y as b,te as c,_ as d,k as f,X as g,ee as j,H as l,U as m,K as p,w as u,re as v,Q as y};

import{s as C,a as T}from"./Error-9392329b.js";import{e as I,f as S}from"./enums-4b2a86a0.js";import{E as i,S as g,I as w}from"./enums-b1d611e3.js";import{F as R,G as d,C as m}from"./enums-64ab819c.js";import{t as _}from"./VertexElementDescriptor-2925c6af.js";import{t as B}from"./typedArrayUtil-c81d173a.js";const y=C.getLogger("esri.views.2d.engine.webgl.Utils"),c="geometry",F=[{name:c,strideInBytes:12}],O=[{name:c,strideInBytes:36}],b=[{name:c,strideInBytes:24}],x=[{name:c,strideInBytes:12}],P=[{name:c,strideInBytes:40}],z=[{name:c,strideInBytes:36}],G=[{name:c,strideInBytes:36}];function l(t){const n={};for(const e of t)n[e.name]=e.strideInBytes;return n}const k=l([{name:c,strideInBytes:36}]),V=l(F),Y=l(O),H=l(b),q=l(x),K=l(P),W=l(z),X=l(G);function It(t,n){switch(t){case i.MARKER:return n===g.HEATMAP?V:k;case i.FILL:switch(n){case g.DOT_DENSITY:return q;case g.SIMPLE:case g.OUTLINE_FILL_SIMPLE:return H;default:return Y}case i.LINE:return K;case i.TEXT:return W;case i.LABEL:return X}}const J=[c],Q=[c],Z=[c],j=[c],tt=[c];function nt(t){switch(t){case i.MARKER:return J;case i.FILL:return Q;case i.LINE:return Z;case i.TEXT:return j;case i.LABEL:return tt}}function et(t){switch(t%4){case 0:case 2:return 4;case 1:case 3:return 1}}function St(t,n){switch(n%4){case 0:case 2:return new Uint32Array(Math.floor(t*n/4));case 1:case 3:return new Uint8Array(t*n)}}function gt(t,n){switch(n%4){case 0:case 2:return new Uint32Array(t);case 1:case 3:return new Uint8Array(t)}}function wt(t){return t!=null}function Tt(t){return typeof t=="number"}function ht(t){switch(t){case"butt":return I.BUTT;case"round":return I.ROUND;case"square":return I.SQUARE;default:return y.error(new T("mapview-invalid-type",`Cap type ${t} is not a valid option. Defaulting to round`)),I.ROUND}}function Et(t){switch(t){case"miter":return S.MITER;case"bevel":return S.BEVEL;case"round":return S.ROUND;default:return y.error(new T("mapview-invalid-type",`Join type ${t} is not a valid option. Defaulting to round`)),S.ROUND}}function Lt(t){switch(t){case"opacity":return w.OPACITY;case"color":return w.COLOR;case"rotation":return w.ROTATION;case"size":return w.SIZE;default:return y.error(`Cannot interpret unknown vv: ${t}`),null}}function Nt(t,n,e,r,a,u,s){for(const f in u){const o=u[f].stride,h=et(o),L=u[f].data,N=e[f].data;if(L==null||N==null)continue;const U=o*a.vertexCount/h,$=o*t/h,v=o*a.vertexFrom/h;for(let p=0;p<U;++p)N[p+$]=L[p+v]}if(s!=null&&r!=null){const f=a.indexCount;for(let o=0;o<f;++o)r[o+n]=s[o+a.indexFrom]-a.vertexFrom+t}}const At={[c]:R.STATIC_DRAW};function Dt(t,n){const e=[];for(let r=0;r<5;++r){const a=nt(r),u={};for(const s of a)u[s]={data:n(r,s)};e.push({data:t(r),buffers:u})}return e}function rt(t){switch(t){case m.BYTE:case m.UNSIGNED_BYTE:return 1;case m.SHORT:case m.UNSIGNED_SHORT:return 2;case m.FLOAT:case m.INT:case m.UNSIGNED_INT:return 4}}function Mt(t){switch(t){case d.UNSIGNED_BYTE:return 1;case d.UNSIGNED_SHORT_4_4_4_4:return 2;case d.FLOAT:return 4;default:return void y.error(new T("webgl-utils",`Unable to handle type ${t}`))}}function Ut(t){switch(t){case d.UNSIGNED_BYTE:return Uint8Array;case d.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case d.FLOAT:return Float32Array;default:return void y.error(new T("webgl-utils",`Unable to handle type ${t}`))}}function at(t){var e;const n={};for(const r in t){const a=t[r];let u=0;n[r]=a.map(s=>{const f=new _(s.name,s.count,s.type,u,0,s.normalized||!1);return u+=s.count*rt(s.type),f}),(e=n[r])==null||e.forEach(s=>s.stride=u)}return n}const st=t=>{const n=new Map;for(const e in t)for(const r of t[e])n.set(r.name,r.location);return n},it=t=>{const n={};for(const e in t){const r=t[e];n[e]=r!=null&&r.length?r[0].stride:0}return n},E=new Map,$t=(t,n)=>{if(!E.has(t)){const e=at(n),r={strides:it(e),bufferLayouts:e,attributes:st(n)};E.set(t,r)}return E.get(t)};function vt(t){t(i.FILL),t(i.LINE),t(i.MARKER),t(i.TEXT),t(i.LABEL)}const Ct=t=>"path"in t&&ct(t.path),Rt=t=>"url"in t&&t.url||"imageData"in t&&t.imageData,_t=t=>"imageData"in t&&t.imageData&&"contentType"in t&&t.contentType?`data:${t.contentType};base64,${t.imageData}`:"url"in t?t.url:null,A=t=>t!=null&&t.startsWith("data:image/gif"),Bt=t=>"url"in t&&t.url&&(t.url.includes(".gif")||A(t.url))||"contentType"in t&&t.contentType==="image/gif"||"imageData"in t&&A(t.imageData),D=t=>t!=null&&t.startsWith("data:image/png"),Ft=t=>"url"in t&&t.url&&(t.url.includes(".png")||D(t.url))||"contentType"in t&&t.contentType==="image/png"||"imageData"in t&&D(t.imageData),Ot=t=>t.type&&t.type.toLowerCase().includes("3d");function bt(t){switch(t.type){case"line":{const n=t;return n.cim.type==="CIMSolidStroke"&&!n.dashTemplate}case"fill":return t.cim.type==="CIMSolidFill";case"esriSFS":return t.style==="esriSFSSolid"||t.style==="esriSFSNull";case"esriSLS":return t.style==="esriSLSSolid"||t.style==="esriSLSNull";default:return!1}}const xt=t=>t.includes("data:image/svg+xml");function Pt(t){switch("cim"in t?t.cim.type:t.type){case"esriSMS":case"esriPMS":case"CIMPointSymbol":return!1;case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":return ut(t);default:return!0}}function zt(t){const n="maxVVSize"in t&&t.maxVVSize,e="width"in t&&t.width||"size"in t&&t.size||0;return n||e}function Gt(t){const n=[];for(let e=0;e<t.length;e++)n.push(t.charCodeAt(e));return n}const ct=t=>!!t&&(t=t.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(t)&&/[\dz]$/i.test(t)&&t.length>4)),ut=t=>{var n,e;return t.type==="fill"&&((e=(n=t==null?void 0:t.cim)==null?void 0:n.markerPlacement)==null?void 0:e.type)==="CIMMarkerPlacementInsidePolygon"},ot=new Float32Array(1);new Uint32Array(ot.buffer);function kt(t){return[255&t,(65280&t)>>>8,(16711680&t)>>>16,(4278190080&t)>>>24]}function Vt(t,n){return 65535&t|n<<16}function M(t,n,e,r){return 255&t|(255&n)<<8|(255&e)<<16|r<<24}function Yt(t,n=0,e=!1){const r=t[n+3];return t[n+0]*=r,t[n+1]*=r,t[n+2]*=r,e||(t[n+3]*=255),t}function Ht(t){if(!t)return 0;const{r:n,g:e,b:r,a}=t;return M(n*a,e*a,r*a,255*a)}function qt(t){if(!t)return 0;const[n,e,r,a]=t;return M(n*(a/255),e*(a/255),r*(a/255),a)}function Kt(t,n,e=0){if(B(n))return t[e+0]=0,t[e+1]=0,t[e+2]=0,void(t[e+3]=0);const{r,g:a,b:u,a:s}=n;t[e+0]=r*s/255,t[e+1]=a*s/255,t[e+2]=u*s/255,t[e+3]=s}export{Tt as $,et as F,Et as G,Dt as H,ut as I,Mt as K,kt as M,gt as P,It as R,Lt as V,Ut as W,At as Y,M as a,qt as b,Ht as c,zt as d,$t as e,Pt as f,Yt as g,Kt as h,Bt as i,Nt as j,ht as k,bt as l,xt as m,Ct as n,Ft as o,Gt as p,Rt as r,_t as s,vt as t,Ot as u,Vt as w,St as x,wt as z};

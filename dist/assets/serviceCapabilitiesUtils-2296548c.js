import{_ as S}from"./preload-helper-41c905a7.js";import{r as C}from"./typedArrayUtil-c81d173a.js";import{e as d,y as g,l as w,a as Q}from"./cast-4d1aa82d.js";import{j as R}from"./Collection-54857936.js";import"./ensureType-8c80e8c7.js";import{h as F}from"./string-bf9c68ed.js";import{d as x,g as T}from"./arcgisLayerUrl-824ee458.js";async function V(t,e){const{WhereClause:r}=await S(()=>import("./WhereClause-daac4082.js").then(o=>o.W),["./WhereClause-daac4082.js","./string-bf9c68ed.js","./typedArrayUtil-c81d173a.js","./executionError-fb3f283a.js","./datetime-b6333958.js"],import.meta.url);return r.create(t,e)}function k(t,e){return C(t)?C(e)?`(${t}) AND (${e})`:t:e}var f;let a=f=class extends w{constructor(t){super(t),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new R}clone(){return new f({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};d([g({type:String,json:{write:!0}})],a.prototype,"floorField",void 0),d([g({json:{read:!1,write:!1}})],a.prototype,"viewAllMode",void 0),d([g({json:{read:!1,write:!1}})],a.prototype,"viewAllLevelIds",void 0),a=f=d([Q("esri.layers.support.LayerFloorInfo")],a);const N=a,M={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function s(t,e,r){return!!(t&&t.hasOwnProperty(e)?t[e]:r)}function y(t,e,r){return t&&t.hasOwnProperty(e)?t[e]:r}function E(t){var r;const e=(r=t==null?void 0:t.supportedSpatialAggregationStatistics)==null?void 0:r.map(o=>o.toLowerCase());return{envelope:!!(e!=null&&e.includes("envelopeaggregate")),centroid:!!(e!=null&&e.includes("centroidaggregate")),convexHull:!!(e!=null&&e.includes("convexhullaggregate"))}}function c(t,e){var o;const r=(o=t==null?void 0:t.supportedOperationsWithCacheHint)==null?void 0:o.map(p=>p.toLowerCase());return!!(r!=null&&r.includes(e.toLowerCase()))}function K(t,e){return{analytics:I(t),attachment:D(t),data:P(t),metadata:O(t),operations:b(t.capabilities,t,e),query:z(t,e),queryRelated:q(t),queryTopFeatures:L(t),editing:$(t)}}function I(t){return{supportsCacheHint:c(t.advancedQueryCapabilities,"queryAnalytics")}}function D(t){const e=t.attachmentProperties,r={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:c(t.advancedQueryCapabilities,"queryAttachments"),supportsResize:s(t,"supportsAttachmentsResizing",!1)};return e&&Array.isArray(e)&&e.forEach(o=>{const p=M[o.name];p&&(r[p]=!!o.isEnabled)}),r}function P(t){return{isVersioned:s(t,"isDataVersioned",!1),supportsAttachment:s(t,"hasAttachments",!1),supportsM:s(t,"hasM",!1),supportsZ:s(t,"hasZ",!1)}}function O(t){return{supportsAdvancedFieldProperties:s(t,"supportsFieldDescriptionProperty",!1)}}function b(t,e,r){const o=t?t.toLowerCase().split(",").map(A=>A.trim()):[],p=r?x(r):null,m=o.includes(C(p)&&p.serverType==="MapServer"?"data":"query"),u=o.includes("editing")&&!e.datesInUnknownTimezone;let i=u&&o.includes("create"),n=u&&o.includes("delete"),l=u&&o.includes("update");const h=o.includes("changetracking"),v=e.advancedQueryCapabilities;return u&&!(i||n||l)&&(i=n=l=!0),{supportsCalculate:s(e,"supportsCalculate",!1),supportsTruncate:s(e,"supportsTruncate",!1),supportsValidateSql:s(e,"supportsValidateSql",!1),supportsAdd:i,supportsDelete:n,supportsEditing:u,supportsChangeTracking:h,supportsQuery:m,supportsQueryAnalytics:s(v,"supportsQueryAnalytic",!1),supportsQueryAttachments:s(v,"supportsQueryAttachments",!1),supportsQueryTopFeatures:s(v,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:s(e,"supportsAttachmentsResizing",!1),supportsSync:o.includes("sync"),supportsUpdate:l,supportsExceedsLimitStatistics:s(e,"supportsExceedsLimitStatistics",!1)}}function z(t,e){const r=t.advancedQueryCapabilities,o=t.ownershipBasedAccessControlForFeatures,p=t.archivingInfo,m=t.currentVersion,u=e==null?void 0:e.includes("MapServer"),i=!u||m>=F("mapserver-pbf-version-support"),n=T(e),l=new Set((t.supportedQueryFormats??"").split(",").map(h=>h.toLowerCase().trim()));return{supportsStatistics:s(r,"supportsStatistics",t.supportsStatistics),supportsPercentileStatistics:s(r,"supportsPercentileStatistics",!1),supportsSpatialAggregationStatistics:s(r,"supportsSpatialAggregationStatistics",!1),supportedSpatialAggregationStatistics:E(r),supportsCentroid:s(r,"supportsReturningGeometryCentroid",!1),supportsDistance:s(r,"supportsQueryWithDistance",!1),supportsDistinct:s(r,"supportsDistinct",t.supportsAdvancedQueries),supportsExtent:s(r,"supportsReturningQueryExtent",!1),supportsGeometryProperties:s(r,"supportsReturningGeometryProperties",!1),supportsHavingClause:s(r,"supportsHavingClause",!1),supportsOrderBy:s(r,"supportsOrderBy",t.supportsAdvancedQueries),supportsPagination:s(r,"supportsPagination",!1),supportsQuantization:s(t,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:s(t,"supportsQuantizationEditMode",!1),supportsQueryGeometry:s(t,"supportsReturningQueryGeometry",!1),supportsResultType:s(r,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:s(r,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:s(r,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:s(t,"useStandardizedQueries",!1),supportsTopFeaturesQuery:s(r,"supportsTopFeaturesQuery",!1),supportsQueryByOthers:s(o,"allowOthersToQuery",!0),supportsHistoricMoment:s(p,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:i&&l.has("pbf"),supportsDisjointSpatialRelationship:s(r,"supportsDisjointSpatialRel",!1),supportsCacheHint:s(r,"supportsQueryWithCacheHint",!1)||c(r,"query"),supportsDefaultSpatialReference:s(r,"supportsDefaultSR",!1),supportsCompactGeometry:n,supportsFullTextSearch:s(r,"supportsFullTextSearch",!1),maxRecordCountFactor:y(t,"maxRecordCountFactor",void 0),maxRecordCount:y(t,"maxRecordCount",void 0),standardMaxRecordCount:y(t,"standardMaxRecordCount",void 0),tileMaxRecordCount:y(t,"tileMaxRecordCount",void 0)}}function q(t){const e=t.advancedQueryCapabilities,r=s(e,"supportsAdvancedQueryRelated",!1);return{supportsPagination:s(e,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r,supportsCacheHint:c(e,"queryRelated")}}function L(t){return{supportsCacheHint:c(t.advancedQueryCapabilities,"queryTopFilter")}}function $(t){const e=t.ownershipBasedAccessControlForFeatures;return{supportsGeometryUpdate:s(t,"allowGeometryUpdates",!0),supportsGlobalId:s(t,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:s(t,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:s(t,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:s(t,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:s(t,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:s(e,"allowAnonymousToDelete",!0),supportsDeleteByOthers:s(e,"allowOthersToDelete",!0),supportsUpdateByAnonymous:s(e,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:s(e,"allowOthersToUpdate",!0)}}export{K as n,N as p,V as r,k as t};

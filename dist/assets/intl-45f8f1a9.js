import{m as c,L as u}from"./number-b98554af.js";import{s as y,a as m}from"./Error-9392329b.js";import{r as U,t as L}from"./string-bf9c68ed.js";import"./locale-30120714.js";import{h as R,l as x}from"./messages-57170cca.js";import{U as B}from"./request-16c6134d.js";import{r as k}from"./typedArrayUtil-c81d173a.js";import{a as A}from"./assets-86d142ff.js";const $=y.getLogger("esri.intl.substitute");function z(t,e,r={}){const{format:n={}}=r;return U(t,s=>O(s,e,n))}function O(t,e,r){let n,s;const o=t.indexOf(":");if(o===-1?n=t.trim():(n=t.slice(0,o).trim(),s=t.slice(o+1).trim()),!n)return"";const i=L(n,e);if(i==null)return"";const a=(s?r==null?void 0:r[s]:null)??(r==null?void 0:r[n]);return a?j(i,a):s?E(i,s):d(i)}function j(t,e){switch(e.type){case"date":return u(t,e.intlOptions);case"number":return c(t,e.intlOptions);default:return $.warn("missing format descriptor for key {key}"),d(t)}}function E(t,e){switch(e.toLowerCase()){case"dateformat":return u(t);case"numberformat":return c(t);default:return $.warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?u(t):/^numberformat/i.test(e)?c(t):d(t)}}function d(t){switch(typeof t){case"string":return t;case"number":return c(t);case"boolean":return""+t;default:return t instanceof Date?u(t):""}}async function v(t,e,r,n){const s=e.exec(r);if(!s)throw new m("esri-intl:invalid-bundle",`Bundle id "${r}" is not compatible with the pattern "${e}"`);const o=s[1]?`${s[1]}/`:"",i=s[2],a=R(n),f=`${o}${i}.json`,w=a?`${o}${i}_${a}.json`:f;let l;try{l=await p(t(w))}catch(b){if(w===f)throw new m("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:b});try{l=await p(t(f))}catch(g){throw new m("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:g})}}return l}async function p(t){if(k(h.fetchBundleAsset))return h.fetchBundleAsset(t);const e=await B(t,{responseType:"text"});return JSON.parse(e.data)}class C{constructor({base:e="",pattern:r,location:n=new URL(window.location.href)}){let s;s=typeof n=="string"?o=>new URL(o,new URL(n,window.location.href)).href:n instanceof URL?o=>new URL(o,n).href:n,this.pattern=typeof r=="string"?new RegExp(`^${r}`):r,this.getAssetUrl=s,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)/)?(.*)$`)}fetchMessageBundle(e,r){return v(this.getAssetUrl,this.matcher,e,r)}}function D(t){return new C(t)}const h={};x(D({pattern:"esri/",location:A}));export{z as s};
